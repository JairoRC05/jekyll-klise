---
layout: null
title: Jugadores
permalink: /busqueda
---

<!-- Bootstrap 5 CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
    .jugador-card {
        transition: transform 0.2s;
        height: 100%;
    }

    .jugador-card:hover {
        transform: translateY(-5px);
    }

    .avatar-img {
        width: 60px;
        height: 60px;
        object-fit: cover;
        border-radius: 8px;
    }

    .rol-badge {
        font-size: 0.85em;
        padding: 4px 8px;
    }
</style>

<div class="container py-4">
    <h1 class="mb-4 text-center">Comunidad de Jugadores</h1>

    <!-- Tabs -->
    <ul class="nav nav-tabs justify-content-center mb-4" id="jugadoresTabs" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="disponibles-tab" data-bs-toggle="tab" data-bs-target="#disponibles"
                type="button">
                Disponibles
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="con-equipo-tab" data-bs-toggle="tab" data-bs-target="#con-equipo"
                type="button">
                Con equipo
            </button>
        </li>
    </ul>

    <!-- Contenido de tabs -->
    <div class="tab-content" id="jugadoresTabContent">
        <!-- Disponibles -->
        <div class="tab-pane fade show active" id="disponibles" role="tabpanel">
            <div id="cargando-disponibles" class="text-center">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Cargando...</span>
                </div>
            </div>
            <div id="grid-disponibles" class="row g-3" style="display:none;"></div>
        </div>

        <!-- Con equipo -->
        <div class="tab-pane fade" id="con-equipo" role="tabpanel">
            <div id="cargando-equipo" class="text-center">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Cargando...</span>
                </div>
            </div>
            <div id="grid-equipo" class="row g-3" style="display:none;"></div>
        </div>
    </div>
</div>

<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>

    const firebaseConfig = {
        apiKey: "AIzaSyBXznASeaw8vtU6OWwiP2kkVBh0L0b45y4",
        authDomain: "unite-mex.firebaseapp.com",
        projectId: "unite-mex",
        appId: "1:248961873504:web:b9ad5434d6a1041bc73505"
    };
    if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();


    // Mapeo de rol a color
    const ROL_COLORES = {
        ADC: 'bg-danger',
        Support: 'bg-success',
        Toplaner: 'bg-primary',
        Jungle: 'bg-warning text-dark',
        Defense: 'bg-info',
        'Capitán': 'bg-dark'
    };

    // Renderizar un jugador en card
    function renderJugador(jugador) {
        const avatar = jugador.avatar || 'female1';
        const rol = jugador.rol || '—';
        const colorRol = ROL_COLORES[rol] || 'bg-secondary';

        return `
      <div class="col-12 col-md-6 col-lg-4">
        <div class="card jugador-card h-100">
          <div class="card-body d-flex align-items-center">
            <img src="/assets/avatars/${avatar}.webp" class="avatar-img me-3" alt="Avatar">
            <div>
              <h5 class="card-title mb-1">${jugador.nickname || 'Jugador'}</h5>
              <span class="rol-badge ${colorRol} rounded">${rol}</span>
            </div>
          </div>
        </div>
      </div>
    `;
    }

    // Cargar jugadores por estado
    async function cargarJugadores(estado, contenedorGrid, contenedorCarga) {
        try {
            let query = db.collection('jugadores_publicos');

            if (estado === 'disponibles') {
                // Equipo == "Disponible" o no definido
                query = query.where('equipo', '==', 'Disponible');
            } else if (estado === 'con-equipo') {
                query = query.where('equipo', '!=', 'Disponible');
                // Nota: Firestore no permite `!=` con null, así que asumimos que todos tienen valor
            }

            const snapshot = await query.get();
            const grid = document.getElementById(contenedorGrid);
            const loading = document.getElementById(contenedorCarga);

            if (snapshot.empty) {
                grid.innerHTML = '<div class="col-12"><p class="text-center text-muted">No hay jugadores.</p></div>';
            } else {
                let html = '';
                snapshot.forEach(doc => {
                    const data = doc.data();
                    // Solo mostrar si es jugador público (evitar admins sin nickname)
                    if (data.nickname) {
                        html += renderJugador(data);
                    }
                });
                grid.innerHTML = html;
            }

            grid.style.display = 'flex';
            loading.style.display = 'none';
        } catch (err) {
            console.error("Error al cargar jugadores:", err);
            document.getElementById(contenedorCarga).innerHTML =
                '<p class="text-danger">Error al cargar. Intenta más tarde.</p>';
        }
    }

    // Cargar al inicio
    document.addEventListener('DOMContentLoaded', () => {
        cargarJugadores('disponibles', 'grid-disponibles', 'cargando-disponibles');
        cargarJugadores('con-equipo', 'grid-equipo', 'cargando-equipo');
    });
</script>